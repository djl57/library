<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densitydpi=device-dpi" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>移动端滚动-慢速滑动，快速滑动效果，还差最后一个功能：点击的时候停止滑动</title>
  <style>
    * {
      padding: 0;
      margin: 0;
    }
    .box {
      position: absolute;
      top: 100px;
      bottom: 100px;
      width: 50%;
      /* left: 20px;
      right: 200px; */
      overflow: hidden;
      border: 1px solid #a0a0a0;
    }
    .right {
      width: 50%;
      height: 500px;
      overflow: scroll;
      border: 1px solid red;
      float: right;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="box">
      <ul class="ul">
        <li class="li">1</li>
        <li class="li">2</li>
        <li class="li">3</li>
        <li class="li">4</li>
        <li class="li">5</li>
        <li class="li">6</li>
        <li class="li">7</li>
        <li class="li">8</li>
        <li class="li">9</li>
        <li class="li">10</li>
        <li class="li">11</li>
        <li class="li">12</li>
        <li class="li">13</li>
        <li class="li">14</li>
        <li class="li">15</li>
        <li class="li">16</li>
        <li class="li">17</li>
        <li class="li">18</li>
        <li class="li">19</li>
        <li class="li">20</li>
        <li class="li">21</li>
        <li class="li">22</li>
        <li class="li">23</li>
        <li class="li">24</li>
        <li class="li">25</li>
        <li class="li">26</li>
        <li class="li">27</li>
        <li class="li">28</li>
        <li class="li">29</li>
        <li class="li">30</li>
        <li class="li">31</li>
        <li class="li">32</li>
        <li class="li">33</li>
        <li class="li">34</li>
        <li class="li">35</li>
        <li class="li">36</li>
        <li class="li">37</li>
        <li class="li">38</li>
        <li class="li">39</li>
        <li class="li">40</li>
        <li class="li">41</li>
        <li class="li">42</li>
        <li class="li">43</li>
        <li class="li">44</li>
        <li class="li">45</li>
        <li class="li">46</li>
        <li class="li">47</li>
        <li class="li">48</li>
        <li class="li">49</li>
        <li class="li">50</li>
        <li class="li">51</li>
        <li class="li">52</li>
        <li class="li">53</li>
        <li class="li">54</li>
        <li class="li">55</li>
        <li class="li">56</li>
        <li class="li">57</li>
        <li class="li">58</li>
        <li class="li">59</li>
        <li class="li">60</li>
        <li class="li">61</li>
        <li class="li">62</li>
        <li class="li">63</li>
        <li class="li">64</li>
        <li class="li">65</li>
        <li class="li">66</li>
        <li class="li">67</li>
        <li class="li">68</li>
        <li class="li">69</li>
        <li class="li">70</li>
        <li class="li">71</li>
        <li class="li">72</li>
        <li class="li">73</li>
        <li class="li">74</li>
        <li class="li">75</li>
        <li class="li">76</li>
        <li class="li">77</li>
        <li class="li">78</li>
        <li class="li">79</li>
        <li class="li">80</li>
        <li class="li">81</li>
        <li class="li">82</li>
        <li class="li">83</li>
        <li class="li">84</li>
        <li class="li">85</li>
        <li class="li">86</li>
        <li class="li">87</li>
        <li class="li">88</li>
        <li class="li">89</li>
        <li class="li">90</li>
        <li class="li">91</li>
        <li class="li">92</li>
        <li class="li">93</li>
        <li class="li">94</li>
        <li class="li">95</li>
        <li class="li">96</li>
        <li class="li">97</li>
        <li class="li">98</li>
        <li class="li">99</li>
        <li class="li">100</li>
        <li class="li">101</li>
        <li class="li">102</li>
        <li class="li">103</li>
        <li class="li">104</li>
        <li class="li">105</li>
        <li class="li">106</li>
        <li class="li">107</li>
        <li class="li">108</li>
        <li class="li">109</li>
        <li class="li">110</li>
        <li class="li">111</li>
        <li class="li">112</li>
        <li class="li">113</li>
        <li class="li">114</li>
        <li class="li">115</li>
        <li class="li">116</li>
        <li class="li">117</li>
        <li class="li">118</li>
        <li class="li">119</li>
        <li class="li">120</li>
        <li class="li">121</li>
        <li class="li">122</li>
        <li class="li">123</li>
        <li class="li">124</li>
        <li class="li">125</li>
        <li class="li">126</li>
        <li class="li">127</li>
        <li class="li">128</li>
        <li class="li">129</li>
        <li class="li">130</li>
        <li class="li">131</li>
        <li class="li">132</li>
        <li class="li">133</li>
        <li class="li">134</li>
        <li class="li">135</li>
        <li class="li">136</li>
        <li class="li">137</li>
        <li class="li">138</li>
        <li class="li">139</li>
        <li class="li">140</li>
        <li class="li">141</li>
        <li class="li">142</li>
        <li class="li">143</li>
        <li class="li">144</li>
        <li class="li">145</li>
        <li class="li">146</li>
        <li class="li">147</li>
        <li class="li">148</li>
        <li class="li">149</li>
        <li class="li">150</li>
        <li class="li">151</li>
        <li class="li">152</li>
        <li class="li">153</li>
        <li class="li">154</li>
        <li class="li">155</li>
        <li class="li">156</li>
        <li class="li">157</li>
        <li class="li">158</li>
        <li class="li">159</li>
        <li class="li">160</li>
        <li class="li">161</li>
        <li class="li">162</li>
        <li class="li">163</li>
        <li class="li">164</li>
        <li class="li">165</li>
        <li class="li">166</li>
        <li class="li">167</li>
        <li class="li">168</li>
        <li class="li">169</li>
        <li class="li">170</li>
        <li class="li">171</li>
        <li class="li">172</li>
        <li class="li">173</li>
        <li class="li">174</li>
        <li class="li">175</li>
        <li class="li">176</li>
        <li class="li">177</li>
        <li class="li">178</li>
        <li class="li">179</li>
        <li class="li">180</li>
        <li class="li">181</li>
        <li class="li">182</li>
        <li class="li">183</li>
        <li class="li">184</li>
        <li class="li">185</li>
        <li class="li">186</li>
        <li class="li">187</li>
        <li class="li">188</li>
        <li class="li">189</li>
        <li class="li">190</li>
        <li class="li">191</li>
        <li class="li">192</li>
        <li class="li">193</li>
        <li class="li">194</li>
        <li class="li">195</li>
        <li class="li">196</li>
        <li class="li">197</li>
        <li class="li">198</li>
        <li class="li">199</li>
        <li class="li">200</li>
        <li class="li">201</li>
        <li class="li">202</li>
        <li class="li">203</li>
        <li class="li">204</li>
        <li class="li">205</li>
        <li class="li">206</li>
        <li class="li">207</li>
        <li class="li">208</li>
        <li class="li">209</li>
        <li class="li">210</li>
        <li class="li">211</li>
        <li class="li">212</li>
        <li class="li">213</li>
        <li class="li">214</li>
        <li class="li">215</li>
        <li class="li">216</li>
        <li class="li">217</li>
        <li class="li">218</li>
        <li class="li">219</li>
        <li class="li">220</li>
        <li class="li">221</li>
        <li class="li">222</li>
        <li class="li">223</li>
        <li class="li">224</li>
        <li class="li">225</li>
        <li class="li">226</li>
        <li class="li">227</li>
        <li class="li">228</li>
        <li class="li">229</li>
        <li class="li">230</li>
        <li class="li">231</li>
        <li class="li">232</li>
        <li class="li">233</li>
        <li class="li">234</li>
        <li class="li">235</li>
        <li class="li">236</li>
        <li class="li">237</li>
        <li class="li">238</li>
        <li class="li">239</li>
        <li class="li">240</li>
        <li class="li">241</li>
        <li class="li">242</li>
        <li class="li">243</li>
        <li class="li">244</li>
        <li class="li">245</li>
        <li class="li">246</li>
        <li class="li">247</li>
        <li class="li">248</li>
        <li class="li">249</li>
        <li class="li">250</li>
        <li class="li">251</li>
        <li class="li">252</li>
        <li class="li">253</li>
        <li class="li">254</li>
        <li class="li">255</li>
        <li class="li">256</li>
        <li class="li">257</li>
        <li class="li">258</li>
        <li class="li">259</li>
        <li class="li">260</li>
        <li class="li">261</li>
        <li class="li">262</li>
        <li class="li">263</li>
        <li class="li">264</li>
        <li class="li">265</li>
        <li class="li">266</li>
        <li class="li">267</li>
        <li class="li">268</li>
        <li class="li">269</li>
        <li class="li">270</li>
        <li class="li">271</li>
        <li class="li">272</li>
        <li class="li">273</li>
        <li class="li">274</li>
        <li class="li">275</li>
        <li class="li">276</li>
        <li class="li">277</li>
        <li class="li">278</li>
        <li class="li">279</li>
        <li class="li">280</li>
        <li class="li">281</li>
        <li class="li">282</li>
        <li class="li">283</li>
        <li class="li">284</li>
        <li class="li">285</li>
        <li class="li">286</li>
        <li class="li">287</li>
        <li class="li">288</li>
        <li class="li">289</li>
        <li class="li">290</li>
        <li class="li">291</li>
        <li class="li">292</li>
        <li class="li">293</li>
        <li class="li">294</li>
        <li class="li">295</li>
        <li class="li">296</li>
        <li class="li">297</li>
        <li class="li">298</li>
        <li class="li">299</li>
        <li class="li">300</li>
        <li class="li">301</li>
        <li class="li">302</li>
        <li class="li">303</li>
        <li class="li">304</li>
        <li class="li">305</li>
        <li class="li">306</li>
        <li class="li">307</li>
        <li class="li">308</li>
        <li class="li">309</li>
        <li class="li">310</li>
        <li class="li">311</li>
        <li class="li">312</li>
        <li class="li">313</li>
        <li class="li">314</li>
        <li class="li">315</li>
        <li class="li">316</li>
        <li class="li">317</li>
        <li class="li">318</li>
        <li class="li">319</li>
        <li class="li">320</li>
        <li class="li">321</li>
        <li class="li">322</li>
        <li class="li">323</li>
        <li class="li">324</li>
        <li class="li">325</li>
        <li class="li">326</li>
        <li class="li">327</li>
        <li class="li">328</li>
        <li class="li">329</li>
        <li class="li">330</li>
        <li class="li">331</li>
        <li class="li">332</li>
        <li class="li">333</li>
        <li class="li">334</li>
        <li class="li">335</li>
        <li class="li">336</li>
        <li class="li">337</li>
        <li class="li">338</li>
        <li class="li">339</li>
        <li class="li">340</li>
        <li class="li">341</li>
        <li class="li">342</li>
        <li class="li">343</li>
        <li class="li">344</li>
        <li class="li">345</li>
        <li class="li">346</li>
        <li class="li">347</li>
        <li class="li">348</li>
        <li class="li">349</li>
        <li class="li">350</li>
        <li class="li">351</li>
        <li class="li">352</li>
        <li class="li">353</li>
        <li class="li">354</li>
        <li class="li">355</li>
        <li class="li">356</li>
        <li class="li">357</li>
        <li class="li">358</li>
        <li class="li">359</li>
        <li class="li">360</li>
        <li class="li">361</li>
        <li class="li">362</li>
        <li class="li">363</li>
        <li class="li">364</li>
        <li class="li">365</li>
        <li class="li">366</li>
        <li class="li">367</li>
        <li class="li">368</li>
        <li class="li">369</li>
        <li class="li">370</li>
        <li class="li">371</li>
        <li class="li">372</li>
        <li class="li">373</li>
        <li class="li">374</li>
        <li class="li">375</li>
        <li class="li">376</li>
        <li class="li">377</li>
        <li class="li">378</li>
        <li class="li">379</li>
        <li class="li">380</li>
        <li class="li">381</li>
        <li class="li">382</li>
        <li class="li">383</li>
        <li class="li">384</li>
        <li class="li">385</li>
        <li class="li">386</li>
        <li class="li">387</li>
        <li class="li">388</li>
        <li class="li">389</li>
        <li class="li">390</li>
        <li class="li">391</li>
        <li class="li">392</li>
        <li class="li">393</li>
        <li class="li">394</li>
        <li class="li">395</li>
        <li class="li">396</li>
        <li class="li">397</li>
        <li class="li">398</li>
        <li class="li">399</li>
        <li class="li">400</li>
        <li class="li">401</li>
        <li class="li">402</li>
        <li class="li">403</li>
        <li class="li">404</li>
        <li class="li">405</li>
        <li class="li">406</li>
        <li class="li">407</li>
        <li class="li">408</li>
        <li class="li">409</li>
        <li class="li">410</li>
        <li class="li">411</li>
        <li class="li">412</li>
        <li class="li">413</li>
        <li class="li">414</li>
        <li class="li">415</li>
        <li class="li">416</li>
        <li class="li">417</li>
        <li class="li">418</li>
        <li class="li">419</li>
        <li class="li">420</li>
        <li class="li">421</li>
        <li class="li">422</li>
        <li class="li">423</li>
        <li class="li">424</li>
        <li class="li">425</li>
        <li class="li">426</li>
        <li class="li">427</li>
        <li class="li">428</li>
        <li class="li">429</li>
        <li class="li">430</li>
        <li class="li">431</li>
        <li class="li">432</li>
        <li class="li">433</li>
        <li class="li">434</li>
        <li class="li">435</li>
        <li class="li">436</li>
        <li class="li">437</li>
        <li class="li">438</li>
        <li class="li">439</li>
        <li class="li">440</li>
        <li class="li">441</li>
        <li class="li">442</li>
        <li class="li">443</li>
        <li class="li">444</li>
        <li class="li">445</li>
        <li class="li">446</li>
        <li class="li">447</li>
        <li class="li">448</li>
        <li class="li">449</li>
        <li class="li">450</li>
        <li class="li">451</li>
        <li class="li">452</li>
        <li class="li">453</li>
        <li class="li">454</li>
        <li class="li">455</li>
        <li class="li">456</li>
        <li class="li">457</li>
        <li class="li">458</li>
        <li class="li">459</li>
        <li class="li">460</li>
        <li class="li">461</li>
        <li class="li">462</li>
        <li class="li">463</li>
        <li class="li">464</li>
        <li class="li">465</li>
        <li class="li">466</li>
        <li class="li">467</li>
        <li class="li">468</li>
        <li class="li">469</li>
        <li class="li">470</li>
        <li class="li">471</li>
        <li class="li">472</li>
        <li class="li">473</li>
        <li class="li">474</li>
        <li class="li">475</li>
        <li class="li">476</li>
        <li class="li">477</li>
        <li class="li">478</li>
        <li class="li">479</li>
        <li class="li">480</li>
        <li class="li">481</li>
        <li class="li">482</li>
        <li class="li">483</li>
        <li class="li">484</li>
        <li class="li">485</li>
        <li class="li">486</li>
        <li class="li">487</li>
        <li class="li">488</li>
        <li class="li">489</li>
        <li class="li">490</li>
        <li class="li">491</li>
        <li class="li">492</li>
        <li class="li">493</li>
        <li class="li">494</li>
        <li class="li">495</li>
        <li class="li">496</li>
        <li class="li">497</li>
        <li class="li">498</li>
        <li class="li">499</li>
        <li class="li">500</li>
      </ul>
    </div>
    <div class="right">
      <ul>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li>6</li>
        <li>7</li>
        <li>8</li>
        <li>9</li>
        <li>10</li>
        <li>11</li>
        <li>12</li>
        <li>13</li>
        <li>14</li>
        <li>15</li>
        <li>16</li>
        <li>17</li>
        <li>18</li>
        <li>19</li>
        <li>20</li>
        <li>21</li>
        <li>22</li>
        <li>23</li>
        <li>24</li>
        <li>25</li>
        <li>26</li>
        <li>27</li>
        <li>28</li>
        <li>29</li>
        <li>30</li>
        <li>31</li>
        <li>32</li>
        <li>33</li>
        <li>34</li>
        <li>35</li>
        <li>36</li>
        <li>37</li>
        <li>38</li>
        <li>39</li>
        <li>40</li>
        <li>41</li>
        <li>42</li>
        <li>43</li>
        <li>44</li>
        <li>45</li>
        <li>46</li>
        <li>47</li>
        <li>48</li>
        <li>49</li>
        <li>50</li>
        <li>51</li>
        <li>52</li>
        <li>53</li>
        <li>54</li>
        <li>55</li>
        <li>56</li>
        <li>57</li>
        <li>58</li>
        <li>59</li>
        <li>60</li>
        <li>61</li>
        <li>62</li>
        <li>63</li>
        <li>64</li>
        <li>65</li>
        <li>66</li>
        <li>67</li>
        <li>68</li>
        <li>69</li>
        <li>70</li>
        <li>71</li>
        <li>72</li>
        <li>73</li>
        <li>74</li>
        <li>75</li>
        <li>76</li>
        <li>77</li>
        <li>78</li>
        <li>79</li>
        <li>80</li>
        <li>81</li>
        <li>82</li>
        <li>83</li>
        <li>84</li>
        <li>85</li>
        <li>86</li>
        <li>87</li>
        <li>88</li>
        <li>89</li>
        <li>90</li>
        <li>91</li>
        <li>92</li>
        <li>93</li>
        <li>94</li>
        <li>95</li>
        <li>96</li>
        <li>97</li>
        <li>98</li>
        <li>99</li>
        <li>100</li>
      </ul>
    </div>
  </div>

  <script>
    // 通过控制transform的translateY(-movepx)的值move来进行滚动，这个move一直是正值，它的大小是绝对值
    // startY  moveY  其中moveY一直在变

    // 通过isFirst判断是否是第一次move

    // 第一次move 通过判断moveY和startY的大小来决定是上移还是下移
    // moveY > startY : 下移 此时当move===0时不能下移 preY = moveY move=move-(moveY-startY) 如果move<0 move = 0
    // moveY < startY : 上移 上移的最大高度为ul-box的高度 preY = moveY move=move+ (startY-moveY)

    // 连续move 通过判断这一次moveY和上一次moveY的大小来决定是上移还是下移
    // moveY > preY : 下移 当move===0时不能下移 preY = moveY move=move-(moveY-preY) 如果move<0 move = 0
    // moveY < preY : 上移 上移的最大高度为ul-box的高度 preY = moveY move=move+ (preY-moveY)

    // 第一次不看滑动速度
    // 在连续move的情况下计算滑动速度，v=x/t
    // 在手指还未放开的时候，位移随着手指的移动而变化
    // 当手指放开的瞬间，滑动速度开始作用
    // 所以决定在touchend的时候计算x和t

    var box = document.getElementsByClassName('box')[0];
    var ul = document.getElementsByClassName('ul')[0];
    var max = ul.offsetHeight - box.offsetHeight;
    var startY,moveY, endY;
    var startTime, endTime, time;
    var displacement;
    var speed, deceleration;
    var inertiaMove, transitionTime;
    var isFirst = true;
    var move = 0;
    box.addEventListener('touchstart', function(e) {
      startY = e.targetTouches[0].pageY;
      startTime = e.timeStamp;
    })
    box.addEventListener('touchmove', function(e) {
      moveY = e.changedTouches[0].pageY;
      // console.log(moveY);
      if (isFirst) {
        if (moveY > startY) {
          if (move !== 0) {
            move = move-(moveY - startY);
            if (move < 0) {
              move = 0;
            }
          } 
        } else {
          move = move + (startY - moveY);
          if (move > max) {
            move = max;
          }
        }
        preY = moveY;
        isFirst = false;
      } else {
        if (moveY > preY) {
          if (move !== 0) {
            move = move-(moveY - preY);
            if (move < 0) {
              move = 0;
            }
          } 
        } else {
          move = move + (preY - moveY);
          if (move > max) {
            move = max;
          }
        }
        preY = moveY;
      }
      ul.style.transform = 'translateY(-'+move+'px)';
      ul.style.transition = `20ms all ease`;
      if (move < 0) {
        ul.style.transform = 'translateY(-' + 0 + 'px)';
        ul.style.transition = `200ms all ease`;
      }
    })
    box.addEventListener('touchend', function(e) {
      isFirst = true;
      endY = e.changedTouches[0].pageY;
      endTime = e.timeStamp;
      time = endTime - startTime;
      displacement = endY - startY;
      speed = displacement/time;

      deceleration = 0.001;
      // 接下来要做初速度为speed，末速度为0，加速度自定义deceleration的减速运动，运动的位移为inertiaMove，运动的时间为transitionTime
      transitionTime = Math.abs(speed * deceleration * 1000 * 1000);

      // 根据transitionTime的大小来决定是否进行快速滑动，人肉眼能察觉的事件间隔大致是0.05-0.1s
      // 所以这里当transitionTime>100时才进行快速滑动
      // 快速滑动def：手指抬起时是否继续滑动
      if (transitionTime > 100) {
        inertiaMove = (speed * speed)/(2 * deceleration);

        // 再判断整个运动是上移还是下移
        // startY > endY 上移 move的大小应该减少
        // startY < endY 下移 move的大小应该增加
        if (startY > endY) {
          if (move + inertiaMove > max) {
            move = max;
          } else {
            move = move + inertiaMove;
          }
        } else {
          if (move !== 0) {
            move = move - inertiaMove;
            if (move < 0) {
              move = 0;
            }
          }
        }
        ul.style.transform = 'translateY(-' + move + 'px)';
        ul.style.transition = transitionTime + 'ms all ease';

        // box.addEventListener('touchstart', clickUl);
        // function clickUl (e) {
        //   console.log('touchstart');
        //   e.preventDefault;
        // }
      }
      // 初速度speed，末速度0
    })
  </script>
</body>
</html>